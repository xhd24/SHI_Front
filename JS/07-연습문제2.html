<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css
/bootstrap.min.css" rel="stylesheet">
</head>

<body>

    <div class="container mt-4">
        <input type="text">
        <button>검색</button>

        <h2>세종시 야간 약국 정보</h2>
        <div id="content">
            <table class="table table-bordered table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>약국명</th>
                        <th>전화번호</th>
                        <th>주소</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>OO약국</td>
                        <td>051-1234-5678</td>
                        <td>부산광역시 해운대구 OOO</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <script>
        const input = document.querySelector('input');
        const button = document.querySelector('button');

        button.addEventListener('click', () => {
            const search = input.value;
            getData(search);
        });

        function getData(search) {
            const url =
                `https://ggoreb.pythonanywhere.com/night_pharmacy/data/?search=${search}`;

            const res = fetch(url, {
                headers: {
                    "Accept": "application/json"
                }
            })

            const res2 = res.then((data) => {
                return data.json();
            })

            res2.then((list) => {
                console.log(list);
                let html = `<table class="table table-bordered table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>약국명</th>
                        <th>전화번호</th>
                        <th>주소</th>
                    </tr>
                </thead>
                <tbody>`

                //    for(const value of list.data){
                //     document.querySelector('tbody').innerHTML+=`<tr>
                //             <td>${value.name}</td>
                //             <td>${value.tel}</td>
                //             <td>${value.road_address}</td>
                //         </tr>`
                //    }

                list.data.forEach(value => {
                    html += `<tr>
                    <td>${value.name}</td>
                    <td>${value.tel}</td>
                    <td>${value.road_address}</td>
                </tr>`
                });
                html += `</tbody>
            </table>`
                document.querySelector('#content').innerHTML = html;

                const trs = document.querySelectorAll('tr');
                for(const tr of trs){
                    tr.addEventListener('click',(e)=>{
                        alert(e.target.innerHTML);
                    })
                }
                
            });

        }





    </script>
</body>